> [!NOTE]
>
> React 团队在 2017 年（**React v16**）引入了全新的 Fiber 架构。这是一种全新的协调引擎，旨在提高 React 应用的性能，尤其是在复杂和高频更新的场景下。

## 传统React架构的局限性

React最初的架构在处理UI更新采用同步的、阻塞的方式。即一次更新会从根节点开始递归遍历整遍整颗组件树，直至完成所有组件的渲染。这种方式在处理简单的ui是表现良好，但随着应用的复杂性增加，特别是处理大量节点或频繁用户交互是，传统架构暴露一下几个主要局限：

- **单次渲染时间过长**：当组件树较大时，一次完整的渲染更新可能会占用大量的时间，这会导致主线程被阻塞，无法响应用户的输入，进而影响用户体验。
- **缺乏优先级管理**：传统架构无法根据任务的重要性分配优先级，所有更新一视同仁，这意味着关键任务（如用户输入处理）可能会被不重要的任务（如低优先级的动画或日志更新）阻塞。
- **中断和恢复困难**：在传统架构中，一旦开始渲染更新，就无法中途中断并恢复，这使得在处理高优先级任务时非常不灵活。

## 为什么需要 Fiber？

为了克服传统 React 架构的局限性，React 团队提出了 Fiber 架构。Fiber 是 React 的一种新的协调引擎，它通过将更新过程**拆分为多个小任务**来解决性能瓶颈和用户体验问题。

#### 性能瓶颈

- **增量渲染**：Fiber 将渲染过程分成多个可以中断的小任务，这样即使组件树非常庞大，每个任务的执行时间也会较短，避免了长时间的阻塞。
- **任务分片**：通过任务分片（Time Slicing）技术，Fiber 可以在空闲时间片段内执行渲染任务，从而最大限度地利用浏览器的空闲时间，提升整体性能。

#### 用户体验问题

- **响应性提升**：通过将任务拆分并分配优先级，Fiber 可以确保高优先级的用户交互任务能够尽快得到处理，而不会被低优先级任务阻塞。
- **平滑的用户体验**：由于渲染过程可以中断并恢复，Fiber 可以更灵活地处理动画和过渡效果，提供更加平滑的用户体验。



## Fiber 的目标

React 团队设计 Fiber 架构的主要目标是：

- **提升性能**：通过增量渲染和任务分片等技术，显著降低长时间渲染任务对用户体验的影响。
- **灵活性和扩展性**：Fiber 架构为未来的新特性和优化奠定了基础，例如 Concurrent Mode 和 Suspense，这些特性能够进一步提升 React 应用的性能和开发体验。
- **可维护性和可调试性**：新的架构不仅提升了性能，还改进了 React 内部的代码结构，使得调试和维护更加容易。

